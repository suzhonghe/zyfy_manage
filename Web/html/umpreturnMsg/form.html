<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta charset="utf-8">
		<title>用户查询</title>
		<style>
        table{width:95%;border:1px solid #e4e4e4;border-collapse:collapse;margin:10px auto 0;}
		th,td{border:1px solid #e4e4e4;line-height: 60px;text-align: center;}
		th{background-color: #e7f4ff;color:#333;}
		td{color:#666666;}
		.operation span,.operation a{color:#333;cursor:pointer;display: inline-block;padding:0 6px;}
		.operation a{color:#45b4ff;}
		.operation .on{color:#333;}
		.operation span:hover,.operation a:hover{text-decoration: underline;}
		li {
			list-style: none;	
			line-height: 32px;
		}
		.title{width:95%;margin:0 auto;padding:6px 0;}
		.headTab{
			width:95%;height:32px;border-bottom:1px solid #d1d1d1;
		}
		.headTab li{
			float:left;padding:0 12px;cursor:pointer;
		}
		.headTab li.on{background-color: #38afff;border-radius:4px;}
		.search{display: none;}
		.search.on{display: block;}
		.backInfo{width:95%;margin:0 auto;}
		.backInfo span{display: inline-block;margin-right: 20px;}
		</style>
	</head>
	<body>
	    <ul class="headTab">
	    	<li class="on">用户查询</li>
	    	<li>交易查询</li>
	    	<li>标的查询</li>
	    	<li>账户流水查询</li>
	    	<li>商户账户查询</li>
	    	<li>绑卡换卡查询</li>
	    </ul>

	    <div class="userSearch search on">
	    	<div class="title">
		    	<label>用户查询：</label>
				<input type="text" id="userAmount" value="" placeholder="如：636A10EB-75FE-4BF9-B0EB-64696D9F3A6F" size="50"/>
				<input type="button" id="userSearchBtn" value="提交"/>
		    </div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>账户号</th>
			                <th>用户号</th>
			                <th>手机号</th>
			                <th>姓名</th>
			                <th>账户余额（元）</th>
			                <th>账户状态</th>
			                <th>返回码</th>
			                <th>返回信息</th>
			                <th>签约的协议</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	    <div class="orderSearch search">
	    	<div class="title">
				订单号：
				<input type="text" id="orderId" value="" placeholder="如：58675702923245600891" size="30"/>
				交易类型：
				<select id="sel">
					<option >请选择交易类型</option>
					<option value="01">充值</option>
					<option value="02">提现</option>
					<option value="03">标的转账</option>
					<option value="04">转账</option>
				</select>
				<span>交易日期:</span>
				<input id="dataStar" class="dateInp" type="text" value="" placeholder="请选择交易日期"/>
				<input type="button" value="提交" id="transferSearch"/>
		    </div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>订单号</th>
			                <th>对账日期</th>
			                <th>订单日期</th>
			                <th>流水号</th>
			                <th>业务类型</th>
			                <th>交易金额（元）</th>
			                <th>手续费（元）</th>
			                <th>原交易金额（元）</th>
			                <th>手续费承担方类型</th>
			                <th>交易状态</th>
			                <th>返回码</th>
			                <th>返回信息</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	    <div class="bidSearch search">
	    	<div class="title">
				<label>标的查询：</label>
				<input type="text" id="loanId" value="" placeholder="如：469DC2B7-E104-4A23-AD2E-EE7335FBF1B5" size="50"/>
				<input type="button" value="提交" id="btn"/>
		    </div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>商户端标的号</th>
			                <th>标的账户号</th>
			                <th>标的状态</th>
			                <th>标的账户状态</th>
			                <th>标的余额（元）</th>
			                <th>返回码</th>
			                <th>返回信息</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	    <div class="accountSearch search">
	    	<div class="title">
				<label>账户流水查询：</label><br />
				<span>联动账户号:</span><input type="text" id="account_id" value="" placeholder="如:02000000094864" size="15"/>
				<span>转账方用户号:</span><input type="text" id="partic_user_id" size="15"/>
				<span>账户类型:</span>
				<select id="account_type">
					<option >账户类型</option>
					<option value="01">个人</option>
					<option value="02">商户</option>
					<option value="03">标的</option>
				</select>
				<span>账户分类:</span>
				<select id="acc_category">
					<option value="00">账户分类</option>
					<option value="01">商户现金账户</option>
					<option value="02">商户手续费账户</option>
				</select>
				<span>交易开始日期:</span>
				<input type="text" id="start_date" class="dateInp" value="" placeholder="交易开始日期" size="10"/>
				<span>交易结束日期:</span>
				<input type="text" id="end_date" class="dateInp" value="" placeholder="交易结束日期" size="10"/>
				<span>起始页:</span>
				<input type="text" size="2" value="1" id="page_num"/>
				<input type="button" id="transeq_search" value="提交"/>
		    </div>
		    <div class="backInfo"><span class="record">总记录数：<strong></strong></span><span class="backCode">返回码：<strong></strong></span><span class="backMessage">返回信息：<strong></strong></span></div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>订单号</th>
			                <th>订单日期</th>
			                <th>借贷方向</th>
			                <th>资金类型</th>
			                <th>交易记账日期</th>
			                <th>交易金额（元）</th>
			                <th>该笔交易后余额（元）</th>
			                <th>交易状态</th>
			                <th>交易类型</th>
			                <th>交易日期</th>
			                <th>交易时间</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	    <div class="MerchantSearch search">
	    	<div class="title">
				<label>商户账户查询：</label><br />
				<span>商户号:</span>
				<input type="text" id="ptpId" value="" placeholder="如：7050044" size="40"/>
				<span>账户类型:</span>
				<select id="selType">
					<option >请选择商户账户类型</option>
					<option value="01">商户现金账户</option>
					<option value="02">商户手续费账户</option>
				</select>
				<input type="button" id="ptpSearch" value="提交"/>
		    </div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>商户号</th>
			                <th>账户类型</th>
			                <th>账户余额（元）</th>
			                <th>账户状态</th>
			                <th>返回码</th>
			                <th>返回信息</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	    <div class="cardSearch search">
	    	<div class="title">
				<label>绑卡换卡查询：</label><br />
				订单号：
				<input type="text" id="bindOrderId" value="" placeholder="如：58675702923245600891" size="30"/>
				<span>交易日期:</span>
				<input id="dataEnd" class="dateInp" type="text" value="" placeholder="请选择交易日期"/>
				<input type="button" id="bindCard" value="提交"/>
		    </div>
		    <div class="tableList">
			    <table>
			        <thead>
			            <tr>
			                <th>订单号</th>
			                <th>订单日期</th>
			                <th>交易状态</th>
			                <th>返回码</th>
			                <th>返回信息</th>
			            </tr>
			        </thead>
			        <tbody>
			        </tbody>
			    </table>
			</div>
	    </div>
	</body>
	<script src="../../js/jquery-1.7.2.js"></script>
	<script src="../../js/jquery.min.1.10.2.js"></script>
	<script src="../../js/newWin.js"></script>
	<script src="../../js/laydate.js"></script>
	<script src="../../js/zycfH.js"></script>
	<script >zycfH.myData();zycfH.alignCenter();</script>
	<script>
	$(function(){
		$(".headTab li").click(function(){
			$(".headTab li").removeClass("on").eq($(this).addClass("on"));
			$(".search").hide().eq($(this).index()).show();
		});
		$("#start_date").click(function(){
			// 时间输入框
	   	    !function(){
	            laydate.skin('molv');//切换皮肤，请查看skins下面皮肤库
	            laydate({elem: '#start_date'});//绑定元素
	        }();
		})
		$("#end_date").click(function(){
	        !function(){
	            laydate.skin('molv');//切换皮肤，请查看skins下面皮肤库
	            laydate({elem: '#end_date'});//绑定元素
	        }();
		})
		//账户流水查询
		$("#transeq_search").click(function(){			
	     	var account_id=$("#account_id").val();
	     	var partic_user_id=$("#partic_user_id").val();
	     	var account_type=$("#account_type").val();
	     	var acc_category=$("#acc_category").val();
	     	var start_date=$("#start_date").val().replace(/-/g,'');
	     	var end_date=$("#end_date").val().replace(/-/g,'');
	     	var page_num=$("#page_num").val();
	     	if(acc_category=="02"&&account_type!="02"){
	     		alert("当账户分类为商户手续费账户时，账户类型必须为商户")
	     		return;
	     	}
	     	if(account_id == "" || partic_user_id == ""){
	     		$.ajax({
		            type:"POST",
		            data : {'account_id':account_id,"partic_user_id":partic_user_id,"account_type":account_type,
		            	 "acc_category":acc_category,"start_date":start_date,"end_date":end_date,"page_num":page_num},
		            url:"../../transeq_search",
		            dataType:"json",
		            success:function(data){
		            	console.log(data);
		            	accountData(data);
		            }
		        });
	     	}else{
	     		alert("联动账户号和转账方用户号必须有一个为空值");
	     	}
	         
		});
		function accountData(obj){
			$(".accountSearch .tableList tbody").html("");
			$(".backInfo .record strong").html(obj.total_num);
			$(".backInfo .backCode strong").html(obj.ret_code);
			$(".backInfo .backMessage strong").html(obj.ret_msg);
			if(!obj.transDetails.length || obj.transDetails.length<1){
	          $(".accountSearch .tableList tbody").html("<td colspan='11'>暂无数据</td>");
	        }else{
	          var len = obj.transDetails.length;
	          for(var i=0;i<len;i++){
	              var oTr = $("<tr></tr>");
	              oTr.html("<td>"+obj.transDetails[i].order_id+"</td><td>"+obj.transDetails[i].order_date+"</td><td>"+obj.transDetails[i].dc_mark+"</td><td>"+obj.transDetails[i].amt_type+"</td><td>"+obj.transDetails[i].acc_check_date+"</td><td>"+obj.transDetails[i].amount+"</td><td>"+obj.transDetails[i].balance+"</td><td>"+obj.transDetails[i].trans_state+"</td><td>"+obj.transDetails[i].trans_type+"</td><td>"+obj.transDetails[i].trans_date+"</td><td>"+obj.transDetails[i].trans_time+"</td>");
	              oTr.appendTo($(".accountSearch .tableList tbody"));
	          };
	        };
		};
		//  用户查询
		$("#userSearchBtn").on("click",function(){
			var userAmount = $("#userAmount").val();
			var tempC;
			if(userAmount !=''){
				tempC = userAmount;
			}
			$.ajax({
				"url":'../../findUmpUserInfo',
				"type":'GET',
				data:{"userId":tempC},
				success: function(data){
					userData(data);

				}
			});
		});
		function userData(obj){
			$(".userSearch .tableList tbody").html("");
            var oTr = $("<tr></tr>");
            oTr.html("<td>"+obj.accountId+"</td><td>"+obj.platUserId+"</td><td>"+obj.contactMobile+"</td><td>"+obj.custName+"</td><td>"+obj.balance+"</td><td>"+obj.accountState+"</td><td>"+obj.retCode+"</td><td>"+obj.retMsg+"</td><td>"+obj.userAgreementList+"</td>");
            oTr.appendTo($(".userSearch .tableList tbody"));
		};
		//标的查询
		$("#btn").click(function(){
	     	var loanId=$("#loanId").val()
	        $.ajax({
	            type:"POST",
	            data : {'loanId':loanId},
	            url:"../../searchUmpLoan",
	            dataType:"json",
	            success:function(data){
	            	bidData(data);
	            },
	            error:function(str){
	              alert("用户未授权");
	            }
	        });
		});
		function bidData(obj){
			$(".bidSearch .tableList tbody").html("");
            var oTr = $("<tr></tr>");
            oTr.html("<td>"+obj.project_id+"</td><td>"+obj.project_account_id+"</td><td>"+obj.project_state+"</td><td>"+obj.project_account_state+"</td><td>"+obj.balance+"</td><td>"+obj.ret_code+"</td><td>"+obj.ret_msg+"</td>");
            oTr.appendTo($(".bidSearch .tableList tbody"));
		};
		//交易查询
		$("#transferSearch").click(function(){
	     	var orderId=$("#orderId").val()
	     	var date=$("#dataStar").val().replace(/-/g,'');
	     	var type=$("#sel").val();
	         $.ajax({
	             type:"POST",
	             data : {'order_id':orderId,"mer_date":date,"busi_type":type},
	             url:"../../transferSearch",
	             dataType:"json",
	             success:function(data){
	            	 console.log(data);
	            	 orderData(data)
	             },
	            error:function(str){
	              alert("用户未授权");
	            }
	         });
		});
		function orderData(obj){
			$(".orderSearch .tableList tbody").html("");
            var oTr = $("<tr></tr>");
            oTr.html("<td>"+obj.order_id+"</td><td>"+obj.mer_date+"</td><td>"+obj.mer_check_date+"</td><td>"+obj.trade_no+"</td><td>"+obj.busi_type+"</td><td>"+obj.amount+"</td><td>"+obj.com_amt+"</td><td>"+obj.orig_amt+"</td><td>"+obj.com_amt_type+"</td><td>"+obj.tran_state+"</td><td>"+obj.ret_code+"</td><td>"+obj.ret_msg+"</td>");
            oTr.appendTo($(".orderSearch .tableList tbody"));
		};
		//商户账户查询
		$("#ptpSearch").click(function(){
	     	var query_mer_id=$("#ptpId").val()
	     	var account_type=$("#selType").val();
	     	
	         $.ajax({
	             type:"POST",
	             data : {'query_mer_id':query_mer_id,"account_type":account_type},
	             url:"../../queryPtpMer",
	             dataType:"json",
	             success:function(data){
	            	 console.log(data);
	            	 MerchantData(data);
	             }
	         });
		})
		function MerchantData(obj){
			$(".MerchantSearch .tableList tbody").html("");
            var oTr = $("<tr></tr>");
            oTr.html("<td>"+obj.query_mer_id+"</td><td>"+obj.account_type+"</td><td>"+obj.balance+"</td><td>"+obj.account_state+"</td><td>"+obj.ret_code+"</td><td>"+obj.ret_msg+"</td>");
            oTr.appendTo($(".MerchantSearch .tableList tbody"));
		};
		//绑卡换卡订单查询(商户--->平台)
		$("#bindCard").click(function(){
	     	var orderId=$("#bindOrderId").val()
	     	var searchDate=$("#dataEnd").val().replace(/-/g,'');
	         $.ajax({
	             type:"POST",
	             data : {'order_id':orderId,"mer_date":searchDate},
	             url:"../../queryBindcard",
	             dataType:"json",
	             success:function(data){
	            	 console.log(data);
	            	 cardData(data);
	             }
	         });
		})
		function cardData(obj){
			$(".cardSearch .tableList tbody").html("");
            var oTr = $("<tr></tr>");
            oTr.html("<td>"+obj.order_id+"</td><td>"+obj.mer_date+"</td><td>"+obj.tran_state+"</td><td>"+obj.ret_code+"</td><td>"+obj.ret_msg+"</td>");
            oTr.appendTo($(".cardSearch .tableList tbody"));
		};
	});
	</script>
</html>