function callback(e,t){var a=["legalPersonPhoto","enterpriseInfoPhoto","contractPhoto","assetsPhoto","othersPhoto"],o=parseInt(t),n=$("<li></li>"),r=$("<img src='"+e+"' />"),i=$("<i>×</i>");i.appendTo(n),r.appendTo(n),n.appendTo($("#"+a[o-1]+" ul")),$("#"+a[o-1]).find("ul li i").each(function(){function e(e){e.get(0).onclick=function(){var e=this;$.ajax({type:"POST",url:"../../deletePhoto",data:{path:$(e).siblings().attr("src"),type:"upload"},success:function(t){alert(t.message),1==t.code&&$(e).parent().remove()}})}}e($(this))})}function uploadError(){alert("上传失败")}$(function(){function e(e){if(e){for(var t=document.getElementById(e),a=t.getElementsByTagName("img"),o=[],n=0;n<a.length;n++)o.push(a[n].getAttribute("src"));return o}}function t(e){$("#"+e+" input").on("change",function(){$("#"+e+" form").submit()})}$(".selectBox").selectBox(),$(".productId").selectBoxCont("../../queryProductByStatus?status=0"),$(".guaranteeRealm").selectBoxCont("../../queryAllCorporationUserByCondition?type=GUARANTEE");var a=window.location.search.substring(1);$.ajax({type:"post",dataType:"json",data:{id:a},url:"../../queryProjectById",success:function(e){function t(e,t){for(var a=e.split(","),o=0;o<a.length;o++){var n=$("<img src="+a[o]+" />"),r=$("<li class='left'></li>"),i=$("<i>×</i>");r.append(n),r.append(i),$("#"+t).find("ul").append(r)}$("#"+t).find("ul").find("i").on("click",function(){var e=$(this),t=$(this).parent().find("img").attr("src");$.ajax({url:"../../deletePhoto",type:"post",data:{path:t,type:"upload"},success:function(t){1==t.code&&e.parent().remove()}})})}if(console.log(e),e){var a=e.project;if(e.assetsPhotoUrl){var o=e.assetsPhotoUrl;t(o,"contractPhoto")}if(e.contractPhotoUrl){var n=e.contractPhotoUrl;t(n,"assetsPhoto")}if(e.enterpriseInfoPhotoUrl){var r=e.enterpriseInfoPhotoUrl;t(r,"enterpriseInfoPhoto")}if(e.legalPersonPhotoUrl){var i=e.legalPersonPhotoUrl;t(i,"legalPersonPhoto")}if(e.othersPhotoUrl){var l=e.othersPhotoUrl;t(l,"othersPhoto")}0==a.mortgaged?$("#noMor").attr("checked",!0):($("Mor").attr("checked",!0),$(".mortgage").show());for(var c,s=0;s<e.productVos.length;s++)a.productId==e.productVos[s].id&&(c=e.productVos[s].productName);$("input[name=projectTitle]").val(a.title),$("input[name=projectSerial]").val(a.serial),$("input[name=projectUserId]").val(a.loanUserId),$(".guaranteeRealm p").html(a.guaranteeRealm),$(".productId p").attr("name",a.productId),$(".productId p").html(c),$("input[name=projectLegalPerson]").val(a.legalPerson),$("input[name=projectAgentPerson]").val(a.agentPerson),$("input[name=projectAmount]").val(a.amount),$("#year").val(a.years),$("#month").val(a.months),$("#day").val(a.days),$(".method p").html("MonthlyInterest"==a.method?"按月付息到期还本":"一次性还本付息"),$("input[name=projectRate]").val(a.rate),$(".method p").attr("name",a.method),$("input[name=projectLoanGuaranteeFee]").val(a.loanGuaranteeFee),$("input[name=projectLoanServiceFee]").val(a.loanServiceFee),$("input[name=projectLoanRiskFee]").val(a.loanRiskFee),$("input[name=projectLoanManageFee]").val(a.loanManageFee),$("input[name=projectLoanInterestFee]").val(a.loanInterestFee),$("input[name=projectInvestInterestFee]").val(a.investInterestFee),$("textarea[name=projectFirmInfo]").val(a.firmInfo),$("textarea[name=projectOperationRange]").val(a.operationRange),$("textarea[name=projectDescription]").val(a.description),$("textarea[name=projectRepaySource]").val(a.repaySource),$("textarea[name=projectRiskInfo]").val(a.riskInfo)}},error:function(){}}),$(".mortgageBox").click(function(){$("#mor").attr("checked")?($(".mortgage").show(),$(".mortgage li").click(function(){})):$(".mortgage").hide()}),$("input[name=projectLoanGuaranteeFee]").val("0"),$("input[name=projectLoanServiceFee]").val("0"),$("input[name=projectLoanRiskFee]").val("0"),$("input[name=projectLoanManageFee]").val("0"),$("input[name=projectLoanInterestFee]").val("0"),$("input[name=projectInvestInterestFee]").val("0"),$(".subAll").click(function(){var t=0,o=null;if($("#noMor").is(":checked"))t=0,o="无";else if($("#mor").is(":checked")){t=1;var n=[];$(".mortgage li").each(function(){$(this).find("input").is(":checked")&&n.push($(this).find("input").next().html())}),o=n.join(",")}var r=new Object;r.id=a,r.title=$("input[name=projectTitle]").val(),r.serial=$("input[name=projectSerial]").val(),r.loanUserId=$("input[name=projectUserId]").val(),r.legalPerson=$("input[name=projectLegalPerson]").val(),r.agentPerson=$("input[name=projectAgentPerson]").val(),r.guaranteeRealm=$(".guaranteeRealm p").html(),r.productId=$(".productId p").attr("name"),r.amount=$("input[name=projectAmount]").val(),r.years=$("#year").val(),r.months=$("#month").val(),r.days=$("#day").val(),r.rate=$("input[name=projectRate]").val(),r.method=$(".method p").attr("name"),r.mortgaged=t,r.mortgagedType=o,r.loanGuaranteeFee=$("input[name=projectLoanGuaranteeFee]").val(),r.loanServiceFee=$("input[name=projectLoanServiceFee]").val(),r.loanRiskFee=$("input[name=projectLoanRiskFee]").val(),r.loanManageFee=$("input[name=projectLoanManageFee]").val(),r.loanInterestFee=$("input[name=projectLoanInterestFee]").val(),r.investInterestFee=$("input[name=projectInvestInterestFee]").val(),r.firmInfo=$("textarea[name=projectFirmInfo]").val(),r.operationRange=$("textarea[name=projectOperationRange]").val(),r.description=$("textarea[name=projectDescription]").val(),r.repaySource=$("textarea[name=projectRepaySource]").val(),r.riskInfo=$("textarea[name=projectRiskInfo]").val();var i=e("legalPersonPhoto"),l=e("enterpriseInfoPhoto"),c=e("contractPhoto"),s=e("assetsPhoto"),p=e("othersPhoto"),u=new Object;return u.project=r,u.legalPersonPhoto=i,u.enterpriseInfoPhoto=l,u.contractPhoto=c,u.assetsPhoto=s,u.othersPhoto=p,console.log(u),""==r.title?void alert("项目名称不能为空"):""==r.serial?void alert("项目唯一号不能为空"):3!=r.serial.split("-").length?void alert("项目唯一号格式不正确"):""==r.loanUserId?void alert("借款人ID不能为空"):""==r.legalPerson&&""==r.agentPerson?void alert("借款单位法人及代理人不能同时为空"):""==r.guaranteeRealm?void alert("关联企业不能为空"):""==$(".productId p").attr("name")||null==$(".productId p").attr("name")?void alert("产品类型不能为空"):""==r.amount?void alert("项目金额不能为空"):""==r.years||""==r.months||""==r.days?void alert("借款期限不能为空"):""==r.rate?void alert("年化利率不能为空"):""==r.method?void alert("还款方式不能为空"):1==r.mortgaged&&""==r.mortgagedType?void alert("抵押品不能为空"):void $.ajax({type:"post",dataType:"json",url:"../../modifyProject",contentType:"application/json",data:JSON.stringify(u),success:function(e){1==e.code?window.location.href="projectManagement.html":alert("提交失败"+e.message)},error:function(){}})}),$(".resAll").click(function(){$(".resetBox").show(),$(".resY").click(function(){$(".resetBox").hide(),$("input").val(""),$("textarea").val("")}),$(".resN").click(function(){$(".resetBox").hide()})}),$("input[name=projectUserId]").next().click(function(){$(".choseId").show(),$(".query").click(function(){$.ajax({type:"post",url:"../../queryLender",data:{loginName:$(".choseId input[name=loginName]").val()},success:function(e){e.idauthenticated=1==e.idauthenticated?"是":"否",$("input[name=loginName]").attr("loanId",e.id),$(".choseId li").eq(1).find("span").eq(1).html(e.name),$(".choseId li").eq(2).find("span").eq(1).html(e.idnumber),$(".choseId li").eq(3).find("span").eq(1).html(e.mobile),$(".choseId li").eq(4).find("span").eq(1).html(e.idauthenticated)}})}),$(".determine span").click(function(){$(".choseId").hide(),$("input[name=projectUserId]").val($("input[name=loginName]").attr("loanId"))})}),t("legalPerson"),t("enterpriseInfo"),t("contract"),t("assets"),t("others")});